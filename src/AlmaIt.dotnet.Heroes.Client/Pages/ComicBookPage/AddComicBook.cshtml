@using AlmaIt.dotnet.Heroes.Shared.Models
@page "/addcomicbook"  
@inject HttpClient Http  
@inject Microsoft.AspNetCore.Blazor.Services.IUriHelper UriHelper  
  
<h1>Create</h1>  
<h3>Comic Book</h3>  
<hr />  
<div class="row">  
    <div class="col-md-4">  
        <form>  
            <div class="form-group">  
                <label for="Title" class="control-label">Title</label>  
                <input for="Title" class="form-control" bind="@comicBook.Title" />  
            </div>  
            <div class="form-group">  
                <label asp-for="IssueNumber" class="control-label">IssueNumber</label>  
                <input for="IssueNumber" class="form-control" bind="@comicBook.IssueNumber" />   
            </div>  
            <div class="form-group">  
                <label asp-for="ParutionDate" class="control-label">ParutionDate</label>  
                <input asp-for="ParutionDate" class="form-control" type="date" id="ParutionDate" bind="@comicBook.ParutionDate" />
            </div>  
            <div class="form-group">  
                <select class="form-control" bind="@selectedComicSerie">
                    <option value="">-- Select Country --</option>
                    @foreach (var comicSerie in comicSerieList)
                    {
                        <option value="@comicSerie.Id">@comicSerie.Name</option>
                    }
                </select>
            </div>  
            <div class="form-group">  
                <button type="submit" class="btn btn-default" onclick="@(async () => await CreateComicBook())">Save</button>  
                <button class="btn" onclick="@cancel">Cancel</button>  
            </div>  
        </form>  
    </div>  
</div>  
  
@functions {  
    ComicBook comicBook = new ComicBook(); 
    int selectedComicSerie = 0; 
    List<ComicSeries> comicSerieList = new List<ComicSeries>();

    protected override async Task OnInitAsync()
    {
        comicSerieList = await Http.GetJsonAsync<List<ComicSeries>>("api/ComicSerie");
    }

    protected async Task CreateComicBook()  
    {  
        if(selectedComicSerie != 0)
            comicBook.SerieId = selectedComicSerie;

        await Http.SendJsonAsync(HttpMethod.Post, "/api/ComicBook", comicBook);  
        UriHelper.NavigateTo("/AllComicBooks");  
    } 

    void cancel()  
    {  
        UriHelper.NavigateTo("/AllComicBooks");  
    }  
}